% from core.src import utils
package functionnal.api;

import controllers.api.results.WSParameterNames;
import controllers.api.results.WSResult;
import controllers.api.results.WSResultCode;
import com.google.gson.Gson;
import com.google.gson.internal.StringMap;
import org.junit.*;
import play.mvc.Http.Request;
import play.mvc.Http.Response;
import play.test.*;

public class {{Group}}Test extends FunctionalTest {

    
    % for webservice in webservices:     
    %   body = ''        
    %   change_param = False
    %   for parameter in webservice.parameters:
    %       if len(body) > 1:
    %           body += '&'  
    %       end    
    %       body += parameter.name
    %       body += '='
    %       body += equ.convert('str-default', parameter.dataType)     
    %       if utils.is_a_list(parameter.dataType) or utils.is_a_map(parameter.dataType):
    %           change_param = True
    %       end
    %   end 
     
     
    @Test
    public void test{{webservice.Name}}() {
        % if change_param:
        // You have to change these parameters : list, hashmap and model are not supported...
        % end
        
        String params = "{{body}}&app_key=API_APP_KEY";
        Response response = {{webservice.METHOD}}("{{webservice.path}}?" + params);
        assertIsOk(response);
        
        String responseBody = response.out.toString();
        Gson gson = new Gson();
        WSResult wsResult = gson.fromJson(responseBody, WSResult.class);
        assertNotNull(wsResult);
        assertEquals(WSResultCode.CODE_SUCCESS, wsResult.getCode());
        assertTrue(wsResult.isSuccess()); 
    }    
    % end
    
}
